/*
 * Copyright (C) 2017-2019 Dremio Corporation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
@import "~@app/uiTheme/less/color-schema.less";
@import "~@app/uiTheme/less/mixins.less";

:global {
  .react-monaco-editor-container .monaco-editor .view-overlays .current-line {
    border: none;
  }

  .monaco-editor {
    line-height: 0px !important;
    border-radius: 4px !important;

    .view-lines {
      font-feature-settings: "zero" on;
      font-variant-ligatures: none;
      font-weight: 400 !important;
    }

    .overflow-guard {
      border-radius: 4px;
    }

    .mtk3 {
      color: @monaco-light-green;
    }
    .mtk7 {
      color: @monaco-persian-green;
    }
    .margin {
      margin: 0px !important;
    }

    .dremio-error-line {
      display: flex;
      align-items: center;
      justify-content: center;

      //circle
      &:before {
        content: "";
        display: block;
        width: 2px;
        height: 100%;
        background: @monaco-error;
      }
    }

    .find-widget .monaco-checkbox .label {
      margin: 0 !important;
    }

    // monaco gives the context menu a z-index of 100 when on localhost, but changes to 8 when on any other instance
    // this forces the context menu to behave consistently
    .context-view.monaco-menu-container {
      z-index: 1000;
    }
  }

  .monaco-editor-hover {
    z-index: 151 !important; // Needs to be above autocomplete suggest-widget which itself has z-index
  }

  //autocomplete styles ------------------------------
  .react-monaco-editor-container .monaco-editor .suggest-widget {
    z-index: 150; // Needs to be above Messages.js (e.g. job error message in content table) which itself has z-index

    .font-basic();

    & > .message {
      display: none;
    }

    & > .tree {
      background-color: @WHITE !important;
      border: none !important;
      border-radius: 4px;
      box-shadow: var(--dremio--shadow--layer-1);
      padding: 8px;
      min-height: 49px;
    }

    .main {
      color: @DARK_900 !important;
      font-family: var(--dremio--font-family) !important;
      font-weight: 400 !important;
      display: flex;
      flex-direction: column;
      padding-left: 3px;

      > .type-label {
        white-space: pre-wrap;
        text-overflow: inherit;
      }
    }

    .monaco-list-rows {
      transform: inherit !important;
      display: flex;
      flex-direction: column;
      top: 0 !important;
      min-height: 32px;
    }

    .monaco-list .monaco-list-row {
      border-radius: 4px;
      height: auto !important;
      padding: 5px 10px;
      position: relative;
      transition: 300ms ease all;
      top: 0 !important;

      //hide suggestion type icon
      .icon {
        &.color {
          background-image: url(../components/Icon/icons/Home.svg) !important;
        }

        &.file {
          background-image: url(../components/Icon/icons/File-Empty.svg) !important;
          background-size: cover !important;
          background-position: 2px 0;
        }

        &.module {
          background-image: url(../components/Icon/icons/Space.svg) !important;
          background-size: cover;
        }

        &.folder {
          background-image: url(../components/Icon/icons/Folder.svg) !important;
          background-size: cover;
        }

        &.function {
          background-image: url(../components/Icon/icons/Function.svg) !important;
        }

        &.constructor {
          background-image: url(../components/Icon/icons/VirtualDataset.svg) !important;
        }

        &.snippet {
          background-image: url(../components/Icon/icons/PhysicalDataset.svg) !important;
          background-size: 70%;
        }

        &.keyword {
          background-image: url(../components/Icon/icons/Keyword.svg) !important;
        }

        &.property {
          background-image: url(../components/Icon/icons/Database.svg) !important;
        }

        &.enum {
          background-image: url(../components/Icon/icons/Boolean.svg) !important;
        }

        &.method {
          background-image: url(../components/Icon/icons/VarBinary.svg) !important;
        }

        &.class {
          background-image: url(../components/Icon/icons/DateType.svg) !important;
        }

        &.interface {
          background-image: url(../components/Icon/icons/Struct.svg) !important;
        }

        &.text {
          background-image: url(../components/Icon/icons/Varchar.svg) !important;
        }

        &.reference {
          background-image: url(../components/Icon/icons/NumDouble.svg) !important;
        }

        &.unit {
          background-image: url(../components/Icon/icons/Num.svg) !important;
        }

        &.variable {
          background-image: url(../components/Icon/icons/Type-List.svg) !important;
        }

        &.field {
          background-image: url(../components/Icon/icons/Type-Map.svg) !important;
        }

        &.value {
          background-image: url(../components/Icon/icons/Type-Other.svg) !important;
        }
      }

      &.focused {
        background-color: @polar;

        &:hover {
          background-color: @polar !important;
        }

        //hide 'i' icon
        > .contents > .main > .readMore {
          display: none;
        }

        > .contents > .main > .type-label {
          text-align: left;
          margin: 0;
        }

        > .contents > .main > .type-label > span {
          color: var(--dremio--color--link);
          &:hover {
            text-decoration: underline;
          }
        }
      }

      &:hover {
        background-color: transparent !important;
      }

      .highlight {
        font-size: 12px !important;
        font-family: var(--dremio--font-family) !important;
        font-weight: 500 !important;
      }
    }

    &.docs-side > .details {
      background: none;
      border: none;
      float: none;
    }

    .details > .monaco-scrollable-element > .body > .header > .close {
      display: none;
    }

    .monaco-scrollable-element > .scrollbar > .slider {
      height: 20px !important;
    }
  }

  // Dark mode for autocomplete
  .vs-dark {
    .react-monaco-editor-container .monaco-editor .suggest-widget > .tree,
    .react-monaco-editor-container .monaco-editor .suggest-widget > .message {
      background-color: @DARK_900 !important;
      color: @WHITE !important;
    }

    .react-monaco-editor-container .monaco-editor .suggest-widget .main {
      color: @DARK_050 !important;
    }

    .react-monaco-editor-container
      .monaco-editor
      .suggest-widget
      .monaco-list
      .monaco-list-row.focused {
      background-color: @FIGMA_NEUTRAL_700 !important;

      &:hover {
        background-color: @FIGMA_NEUTRAL_600 !important;
      }
    }

    .suggest-widget .monaco-list {
      .monaco-scrollable-element {
        min-height: 39px;
      }
      .monaco-list-row .icon {
        &.color,
        &.unit,
        &.references,
        &.text,
        &.interface,
        &.class,
        &.method,
        &.operator,
        &.property,
        &.function,
        &.keyword {
          filter: grayscale(1) brightness(1.8);
        }
      }
    }
  }
  //------------------------------------------------------
}
